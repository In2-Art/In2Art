"use strict";(self.webpackChunkWebAppNew=self.webpackChunkWebAppNew||[]).push([[979],{4094:(k,P,d)=>{d.d(P,{r:()=>R});var y=d(1208),e=d(4650),T=d(4006);let v=(()=>{class x{constructor(){this.autocomplete="off"}disableKeys(m){return document,8==m.keyCode||m.keyCode>=48&&m.keyCode<=57}}return x.\u0275fac=function(m){return new(m||x)},x.\u0275dir=e.\u0275\u0275defineDirective({type:x,selectors:[["","onlyNumbers",""]],hostVars:1,hostBindings:function(m,p){1&m&&e.\u0275\u0275listener("keypress",function(O){return p.disableKeys(O)}),2&m&&e.\u0275\u0275hostProperty("autocomplete",p.autocomplete)}}),x})();const b=["input"];let R=(()=>{class x{constructor(){this.imageChangedEvent="",this.croppedImage="",this.canvasRotation=0,this.rotation=0,this.scale=1,this.showCropper=!1,this.containWithinAspectRatio=!1,this.transform={}}fileChangeEvent(m){this.imageChangedEvent=m}imageCropped(m){this.croppedImage=m.base64,console.log(m,(0,y.Ll)(m.base64))}imageLoaded(){this.showCropper=!0,console.log("Image loaded")}cropperReady(m){console.log("Cropper ready",m)}loadImageFailed(){console.log("Load failed")}rotateLeft(){this.canvasRotation--,this.flipAfterRotate()}rotateRight(){this.canvasRotation++,this.flipAfterRotate()}flipAfterRotate(){this.transform={...this.transform,flipH:this.transform.flipV,flipV:this.transform.flipH}}flipHorizontal(){this.transform={...this.transform,flipH:!this.transform.flipH}}flipVertical(){this.transform={...this.transform,flipV:!this.transform.flipV}}zoomOut(){this.scale-=.1,this.transform={...this.transform,scale:this.scale}}zoomIn(){this.scale+=.1,this.transform={...this.transform,scale:this.scale}}toggleContainWithinAspectRatio(){this.containWithinAspectRatio=!this.containWithinAspectRatio}updateRotation(){this.transform={...this.transform,rotate:this.rotation}}removePhoto(){this.input.nativeElement.value="",this.fileChangeEvent(null),this.croppedImage=null}mostrarBotons(){return!!this.input&&this.input.nativeElement.value}}return x.\u0275fac=function(m){return new(m||x)},x.\u0275cmp=e.\u0275\u0275defineComponent({type:x,selectors:[["app-image-croper"]],viewQuery:function(m,p){if(1&m&&e.\u0275\u0275viewQuery(b,5),2&m){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(p.input=_.first)}},decls:30,vars:28,consts:function(){let M,m,p,_,O,g,A,l,w,L,D;return M="Choose Your Image",m="Rotate left",p="Rotate right",_="Flip horizontal",O="Flip vertical",g=" " + "\ufffd0\ufffd" + " ",A="Remove photo",l="Rotation",w="Rotation",L="Zoom -",D="Zoom +",[["format","png",3,"imageChangedEvent","maintainAspectRatio","containWithinAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth","onlyScaleDown","roundCropper","canvasRotation","transform","alignImage","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"boto-showcase"],[1,"image-cropper-btn"],["placeholder",M,"type","file",1,"btn","inputImage",3,"change"],["input",""],[1,"text-center","my-2"],[1,"croppedImage","shadow-4",3,"src"],[1,"boto","botoSecundari","botoPetit",3,"click"],m,p,_,O,g,[1,"boto","botoVermell","botoPetit",3,"click"],A,["for","rotation",1,"col-form-label"],l,["placeholder",w,"type","text","onlyNumbers","",1,"btn","ml-2",3,"ngModel","ngModelChange","keyup"],L,D]},template:function(m,p){1&m&&(e.\u0275\u0275elementStart(0,"image-cropper",0),e.\u0275\u0275listener("imageCropped",function(O){return p.imageCropped(O)})("imageLoaded",function(){return p.imageLoaded()})("cropperReady",function(O){return p.cropperReady(O)})("loadImageFailed",function(){return p.loadImageFailed()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"input",3,4),e.\u0275\u0275listener("change",function(O){return p.fileChangeEvent(O)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",5),e.\u0275\u0275element(6,"img",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div")(8,"button",7),e.\u0275\u0275listener("click",function(){return p.rotateLeft()}),e.\u0275\u0275i18n(9,8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"button",7),e.\u0275\u0275listener("click",function(){return p.rotateRight()}),e.\u0275\u0275i18n(11,9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"button",7),e.\u0275\u0275listener("click",function(){return p.flipHorizontal()}),e.\u0275\u0275i18n(13,10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"button",7),e.\u0275\u0275listener("click",function(){return p.flipVertical()}),e.\u0275\u0275i18n(15,11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"div")(17,"button",7),e.\u0275\u0275listener("click",function(){return p.toggleContainWithinAspectRatio()}),e.\u0275\u0275i18n(18,12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"button",13),e.\u0275\u0275listener("click",function(){return p.removePhoto()}),e.\u0275\u0275i18n(20,14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div")(22,"label",15),e.\u0275\u0275i18n(23,16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"input",17),e.\u0275\u0275listener("ngModelChange",function(O){return p.rotation=O})("keyup",function(){return p.updateRotation()}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(25,"div")(26,"button",7),e.\u0275\u0275listener("click",function(){return p.zoomOut()}),e.\u0275\u0275i18n(27,18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"button",7),e.\u0275\u0275listener("click",function(){return p.zoomIn()}),e.\u0275\u0275i18n(29,19),e.\u0275\u0275elementEnd()()()),2&m&&(e.\u0275\u0275styleProp("display",p.showCropper?null:"none")("display",p.mostrarBotons()?"block":"none"),e.\u0275\u0275property("imageChangedEvent",p.imageChangedEvent)("maintainAspectRatio",!0)("containWithinAspectRatio",p.containWithinAspectRatio)("aspectRatio",1)("resizeToWidth",256)("cropperMinWidth",128)("onlyScaleDown",!0)("roundCropper",!1)("canvasRotation",p.canvasRotation)("transform",p.transform)("alignImage","left"),e.\u0275\u0275advance(5),e.\u0275\u0275styleProp("display",p.mostrarBotons()?"block":"none"),e.\u0275\u0275advance(1),e.\u0275\u0275property("src",p.croppedImage,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("display",p.mostrarBotons()?"block":"none"),e.\u0275\u0275advance(9),e.\u0275\u0275styleProp("display",p.mostrarBotons()?"block":"none"),e.\u0275\u0275advance(2),e.\u0275\u0275i18nExp(p.containWithinAspectRatio?"Fill Aspect Ratio":"Contain Within Aspect Ratio"),e.\u0275\u0275i18nApply(18),e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("display",p.mostrarBotons()?"block":"none"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",p.rotation),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("display",p.mostrarBotons()?"block":"none"))},dependencies:[T.Fj,T.JJ,T.On,v,y.ap],styles:[".btn[_ngcontent-%COMP%]{border-radius:20px}input.btn[_ngcontent-%COMP%], input.btn[_ngcontent-%COMP%]:hover{color:var(--color-text)}.btn-showcase[_ngcontent-%COMP%]{text-align:center}input.btn[_ngcontent-%COMP%]{border-color:inherit}.inputImage[_ngcontent-%COMP%]{margin:10px}.croppedImage[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:36px;border-radius:10000px}[_nghost-%COMP%]     .overlay{outline:none!important}[_nghost-%COMP%]     .cropper{border-radius:10000px;outline-color:#2222224d!important}"]}),x})()},9806:(k,P,d)=>{d.d(P,{z:()=>b});var y=d(6895),e=d(660),T=d(1208),v=d(4650);let b=(()=>{class R{}return R.\u0275fac=function(M){return new(M||R)},R.\u0275mod=v.\u0275\u0275defineNgModule({type:R}),R.\u0275inj=v.\u0275\u0275defineInjector({imports:[y.CommonModule,e.m,T.QG]}),R})()},6362:(k,P,d)=>{d.d(P,{N:()=>b});var y=d(5861),e=d(4650),T=d(9696),v=d(1572);let b=(()=>{class R{constructor(M){this.main=M,this.freq=3}ngOnInit(){return(0,y.Z)(function*(){})()}timeout(){}}return R.\u0275fac=function(M){return new(M||R)(e.\u0275\u0275directiveInject(T.J))},R.\u0275cmp=e.\u0275\u0275defineComponent({type:R,selectors:[["app-loading"]],decls:1,vars:0,template:function(M,m){1&M&&e.\u0275\u0275element(0,"mat-spinner")},dependencies:[v.Ou],styles:["[_nghost-%COMP%]     mat-spinner{margin:20px auto}[_nghost-%COMP%]     mat-spinner circle{stroke:#cacaca}.logo[_ngcontent-%COMP%]{width:100px;animation:girar 1s linear infinite normal}@keyframes girar{to{transform:rotate(360deg)}}"]}),R})()},5219:(k,P,d)=>{d.d(P,{T:()=>O});var y=d(5861),e=d(4650),T=d(9696),v=d(6895);function b(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275i18n(1,3),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(l.text||l.nomText+" is required"),e.\u0275\u0275i18nApply(1)}}function R(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275i18n(1,4),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(l.nomText)(l.control.errors.minlength.actualLength)(null==l.control.errors?null:l.control.errors.minlength.requiredLength),e.\u0275\u0275i18nApply(1)}}function x(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275i18n(1,5),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(l.nomText)(l.control.errors.maxlength.actualLength)(null==l.control.errors?null:l.control.errors.maxlength.requiredLength),e.\u0275\u0275i18nApply(1)}}function M(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275i18n(1,6),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(l.nomText),e.\u0275\u0275i18nApply(1)}}function m(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",l.nomText," already exists")}}function p(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275i18n(1,7),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(l.nomText),e.\u0275\u0275i18nApply(1)}}function _(g,A){if(1&g&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,b,2,1,"div",1),e.\u0275\u0275template(2,R,2,3,"div",1),e.\u0275\u0275template(3,x,2,3,"div",1),e.\u0275\u0275template(4,M,2,1,"div",1),e.\u0275\u0275template(5,m,2,1,"div",1),e.\u0275\u0275template(6,p,2,1,"div",1),e.\u0275\u0275elementEnd()),2&g){const l=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.minlength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.maxlength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.email),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.notUnique),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==l.control.errors?null:l.control.errors.pattern)}}let O=(()=>{class g{constructor(l){this.main=l}ngOnInit(){return(0,y.Z)(function*(){})()}}return g.\u0275fac=function(l){return new(l||g)(e.\u0275\u0275directiveInject(T.J))},g.\u0275cmp=e.\u0275\u0275defineComponent({type:g,selectors:[["app-missatge-error-form"]],inputs:{control:"control",text:"text",nomText:"nomText"},decls:1,vars:1,consts:function(){let A,l,w,L,D;return A="" + "\ufffd0\ufffd" + "",l="" + "\ufffd0\ufffd" + " is too short (" + "\ufffd1\ufffd" + "/" + "\ufffd2\ufffd" + ")",w="" + "\ufffd0\ufffd" + " is too long (" + "\ufffd1\ufffd" + "/" + "\ufffd2\ufffd" + ")",L="" + "\ufffd0\ufffd" + " has a wrong format",D="" + "\ufffd0\ufffd" + " has a wrong format",[[4,"ngIf"],["class","textErrorForm",4,"ngIf"],[1,"textErrorForm"],A,l,w,L,D]},template:function(l,w){1&l&&e.\u0275\u0275template(0,_,7,6,"div",0),2&l&&e.\u0275\u0275property("ngIf",null==w.control?null:w.control.touched)},dependencies:[v.NgIf]}),g})()},1208:(k,P,d)=>{d.d(P,{Ll:()=>ce,QG:()=>se,ap:()=>ae});var y=d(5861),e=d(4650),T=d(1481),v=d(6895);const b=["wrapper"],R=["sourceImage"];function x(s,c){if(1&s){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"img",4,5),e.\u0275\u0275listener("load",function(){e.\u0275\u0275restoreView(t);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.imageLoadedInView())})("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Drag))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Drag))}),e.\u0275\u0275elementEnd()}if(2&s){const t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),e.\u0275\u0275classProp("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),e.\u0275\u0275property("src",t.safeImgDataUrl,e.\u0275\u0275sanitizeUrl)}}function M(s,c){if(1&s){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",9),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"topleft"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"topleft"))}),e.\u0275\u0275element(2,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span",11),e.\u0275\u0275element(4,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",12),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"topright"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"topright"))}),e.\u0275\u0275element(6,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"span",13),e.\u0275\u0275element(8,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"span",14),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottomright"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottomright"))}),e.\u0275\u0275element(10,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"span",15),e.\u0275\u0275element(12,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"span",16),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottomleft"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottomleft"))}),e.\u0275\u0275element(14,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"span",17),e.\u0275\u0275element(16,"span",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"span",18),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"top"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"top"))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"span",19),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"right"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"right"))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"span",20),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottom"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"bottom"))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"span",21),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"left"))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Resize,"left"))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}}function m(s,c){if(1&s){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275listener("keydown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.keyboardAccess(n))}),e.\u0275\u0275elementStart(1,"div",7),e.\u0275\u0275listener("mousedown",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Move))})("touchstart",function(n){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.startMove(n,o.moveTypes.Move))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,M,21,0,"ng-container",8),e.\u0275\u0275elementEnd()}if(2&s){const t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),e.\u0275\u0275classProp("ngx-ic-round",t.roundCropper),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.hideResizeSquares)}}class p{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t]),this.validateOptions()}setOptionsFromChanges(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var _=(()=>{return(s=_||(_={})).Drag="drag",s.Move="move",s.Resize="resize",s.Pinch="pinch",_;var s})();function w(s,c){return s/100*c}let L=(()=>{class s{crop(t,i,n,o){const r=this.getImagePosition(t,i,n,o),a=r.x2-r.x1,h=r.y2-r.y1,u=document.createElement("canvas");u.width=a,u.height=h;const C=u.getContext("2d");if(!C)return null;null!=o.backgroundColor&&(C.fillStyle=o.backgroundColor,C.fillRect(0,0,a,h));const f=(o.transform.scale||1)*(o.transform.flipH?-1:1),N=(o.transform.scale||1)*(o.transform.flipV?-1:1),{translateH:W,translateV:z}=this.getCanvasTranslate(t,i,o),I=i.transformed;C.setTransform(f,0,0,N,I.size.width/2+W,I.size.height/2+z),C.translate(-r.x1/f,-r.y1/N),C.rotate((o.transform.rotate||0)*Math.PI/180),C.drawImage(I.image,-I.size.width/2,-I.size.height/2);const S={width:a,height:h,imagePosition:r,cropperPosition:{...n}};o.containWithinAspectRatio&&(S.offsetImagePosition=this.getOffsetImagePosition(t,i,n,o));const $=this.getResizeRatio(a,h,o);return 1!==$&&(S.width=Math.round(a*$),S.height=o.maintainAspectRatio?Math.round(S.width/o.aspectRatio):Math.round(h*$),function l(s,c,t){const i=s.width,n=s.height,o=i/(c=Math.round(c)),r=n/(t=Math.round(t)),a=Math.ceil(o/2),h=Math.ceil(r/2),u=s.getContext("2d");if(u){const C=u.getImageData(0,0,i,n),f=u.createImageData(c,t),N=C.data,W=f.data;for(let z=0;z<t;z++)for(let I=0;I<c;I++){const S=4*(I+z*c),$=z*r;let F=0,B=0,Y=0,K=0,j=0,Z=0,q=0;const le=Math.floor(I*o),he=Math.floor(z*r);let U=Math.ceil((I+1)*o),X=Math.ceil((z+1)*r);U=Math.min(U,i),X=Math.min(X,n);for(let V=he;V<X;V++){const J=Math.abs($-V)/h,pe=I*o,_e=J*J;for(let Q=le;Q<U;Q++){const ee=Math.abs(pe-Q)/a,H=Math.sqrt(_e+ee*ee);if(H>=1)continue;F=2*H*H*H-3*H*H+1;const G=4*(Q+V*i);q+=F*N[G+3],Y+=F,N[G+3]<255&&(F=F*N[G+3]/250),K+=F*N[G],j+=F*N[G+1],Z+=F*N[G+2],B+=F}}W[S]=K/B,W[S+1]=j/B,W[S+2]=Z/B,W[S+3]=q/Y}s.width=c,s.height=t,u.putImageData(f,0,0)}}(u,S.width,S.height)),S.base64=u.toDataURL("image/"+o.format,this.getQuality(o)),S}getCanvasTranslate(t,i,n){if("px"===n.transform.translateUnit){const o=this.getRatio(t,i);return{translateH:(n.transform.translateH||0)*o,translateV:(n.transform.translateV||0)*o}}return{translateH:n.transform.translateH?w(n.transform.translateH,i.transformed.size.width):0,translateV:n.transform.translateV?w(n.transform.translateV,i.transformed.size.height):0}}getRatio(t,i){return i.transformed.size.width/t.nativeElement.offsetWidth}getImagePosition(t,i,n,o){const r=this.getRatio(t,i),a={x1:Math.round(n.x1*r),y1:Math.round(n.y1*r),x2:Math.round(n.x2*r),y2:Math.round(n.y2*r)};return o.containWithinAspectRatio||(a.x1=Math.max(a.x1,0),a.y1=Math.max(a.y1,0),a.x2=Math.min(a.x2,i.transformed.size.width),a.y2=Math.min(a.y2,i.transformed.size.height)),a}getOffsetImagePosition(t,i,n,o){const h=i.transformed.size.width/t.nativeElement.offsetWidth;let u,C;(o.canvasRotation+i.exifTransform.rotate)%2?(u=(i.transformed.size.width-i.original.size.height)/2,C=(i.transformed.size.height-i.original.size.width)/2):(u=(i.transformed.size.width-i.original.size.width)/2,C=(i.transformed.size.height-i.original.size.height)/2);const f={x1:Math.round(n.x1*h)-u,y1:Math.round(n.y1*h)-C,x2:Math.round(n.x2*h)-u,y2:Math.round(n.y2*h)-C};return o.containWithinAspectRatio||(f.x1=Math.max(f.x1,0),f.y1=Math.max(f.y1,0),f.x2=Math.min(f.x2,i.transformed.size.width),f.y2=Math.min(f.y2,i.transformed.size.height)),f}getResizeRatio(t,i,n){const o=n.resizeToWidth/t,r=n.resizeToHeight/i,a=new Array;n.resizeToWidth>0&&a.push(o),n.resizeToHeight>0&&a.push(r);const h=0===a.length?1:Math.min(...a);return h>1&&!n.onlyScaleDown?h:Math.min(h,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),D=(()=>{class s{resetCropperPosition(t,i,n){if(!t?.nativeElement)return;const o=t.nativeElement;if(n.cropperStaticHeight&&n.cropperStaticWidth)i.x1=0,i.x2=o.offsetWidth>n.cropperStaticWidth?n.cropperStaticWidth:o.offsetWidth,i.y1=0,i.y2=o.offsetHeight>n.cropperStaticHeight?n.cropperStaticHeight:o.offsetHeight;else{const r=Math.min(n.cropperScaledMaxWidth,o.offsetWidth),a=Math.min(n.cropperScaledMaxHeight,o.offsetHeight);if(n.maintainAspectRatio)if(o.offsetWidth/n.aspectRatio<o.offsetHeight){i.x1=0,i.x2=r;const h=r/n.aspectRatio;i.y1=(o.offsetHeight-h)/2,i.y2=i.y1+h}else{i.y1=0,i.y2=a;const h=a*n.aspectRatio;i.x1=(o.offsetWidth-h)/2,i.x2=i.x1+h}else i.x1=0,i.x2=r,i.y1=0,i.y2=a}}move(t,i,n){const o=this.getClientX(t)-i.clientX,r=this.getClientY(t)-i.clientY;n.x1=i.x1+o,n.y1=i.y1+r,n.x2=i.x2+o,n.y2=i.y2+r}resize(t,i,n,o,r){const a=this.getClientX(t)-i.clientX,h=this.getClientY(t)-i.clientY;switch(i.position){case"left":n.x1=Math.min(Math.max(i.x1+a,n.x2-r.cropperScaledMaxWidth),n.x2-r.cropperScaledMinWidth);break;case"topleft":n.x1=Math.min(Math.max(i.x1+a,n.x2-r.cropperScaledMaxWidth),n.x2-r.cropperScaledMinWidth),n.y1=Math.min(Math.max(i.y1+h,n.y2-r.cropperScaledMaxHeight),n.y2-r.cropperScaledMinHeight);break;case"top":n.y1=Math.min(Math.max(i.y1+h,n.y2-r.cropperScaledMaxHeight),n.y2-r.cropperScaledMinHeight);break;case"topright":n.x2=Math.max(Math.min(i.x2+a,n.x1+r.cropperScaledMaxWidth),n.x1+r.cropperScaledMinWidth),n.y1=Math.min(Math.max(i.y1+h,n.y2-r.cropperScaledMaxHeight),n.y2-r.cropperScaledMinHeight);break;case"right":n.x2=Math.max(Math.min(i.x2+a,n.x1+r.cropperScaledMaxWidth),n.x1+r.cropperScaledMinWidth);break;case"bottomright":n.x2=Math.max(Math.min(i.x2+a,n.x1+r.cropperScaledMaxWidth),n.x1+r.cropperScaledMinWidth),n.y2=Math.max(Math.min(i.y2+h,n.y1+r.cropperScaledMaxHeight),n.y1+r.cropperScaledMinHeight);break;case"bottom":n.y2=Math.max(Math.min(i.y2+h,n.y1+r.cropperScaledMaxHeight),n.y1+r.cropperScaledMinHeight);break;case"bottomleft":n.x1=Math.min(Math.max(i.x1+a,n.x2-r.cropperScaledMaxWidth),n.x2-r.cropperScaledMinWidth),n.y2=Math.max(Math.min(i.y2+h,n.y1+r.cropperScaledMaxHeight),n.y1+r.cropperScaledMinHeight);break;case"center":const u=t.scale,C=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(i.x2-i.x1)*u),r.cropperScaledMaxWidth),f=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(i.y2-i.y1)*u),r.cropperScaledMaxHeight);n.x1=i.clientX-C/2,n.x2=i.clientX+C/2,n.y1=i.clientY-f/2,n.y2=i.clientY+f/2,n.x1<0?(n.x2-=n.x1,n.x1=0):n.x2>o.width&&(n.x1-=n.x2-o.width,n.x2=o.width),n.y1<0?(n.y2-=n.y1,n.y1=0):n.y2>o.height&&(n.y1-=n.y2-o.height,n.y2=o.height)}r.maintainAspectRatio&&this.checkAspectRatio(i.position,n,o,r)}checkAspectRatio(t,i,n,o){let r=0,a=0;switch(t){case"top":i.x2=i.x1+(i.y2-i.y1)*o.aspectRatio,r=Math.max(i.x2-n.width,0),a=Math.max(0-i.y1,0),(r>0||a>0)&&(i.x2-=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y1+=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*o.aspectRatio,r=Math.max(i.x2-n.width,0),a=Math.max(i.y2-n.height,0),(r>0||a>0)&&(i.x2-=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y2-=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/o.aspectRatio,r=Math.max(0-i.x1,0),a=Math.max(0-i.y1,0),(r>0||a>0)&&(i.x1+=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y1+=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/o.aspectRatio,r=Math.max(i.x2-n.width,0),a=Math.max(0-i.y1,0),(r>0||a>0)&&(i.x2-=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y1+=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/o.aspectRatio,r=Math.max(i.x2-n.width,0),a=Math.max(i.y2-n.height,0),(r>0||a>0)&&(i.x2-=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y2-=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/o.aspectRatio,r=Math.max(0-i.x1,0),a=Math.max(i.y2-n.height,0),(r>0||a>0)&&(i.x1+=a*o.aspectRatio>r?a*o.aspectRatio:r,i.y2-=a*o.aspectRatio>r?a:r/o.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*o.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/o.aspectRatio;const h=Math.max(0-i.x1,0),u=Math.max(i.x2-n.width,0),C=Math.max(i.y2-n.height,0),f=Math.max(0-i.y1,0);(h>0||u>0||C>0||f>0)&&(i.x1+=C*o.aspectRatio>h?C*o.aspectRatio:h,i.x2-=f*o.aspectRatio>u?f*o.aspectRatio:u,i.y1+=f*o.aspectRatio>u?f:u/o.aspectRatio,i.y2-=C*o.aspectRatio>h?C:h/o.aspectRatio)}}getClientX(t){return t.touches?.[0].clientX||t.clientX||0}getClientY(t){return t.touches?.[0].clientY||t.clientY||0}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();let re=(()=>{class s{constructor(){this.autoRotateSupported=function te(){return new Promise(s=>{const c=new Image;c.onload=()=>{s(1===c.width&&2===c.height)},c.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,i){return new Promise((n,o)=>{const r=new FileReader;r.onload=a=>{this.loadImage(a.target.result,t.type,i).then(n).catch(o)},r.readAsDataURL(t)})}loadImage(t,i,n){return this.isValidImageType(i)?this.loadBase64Image(t,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,i){return new Promise((n,o)=>{const r=new Image;r.onerror=()=>o,r.onload=()=>{const a=document.createElement("canvas"),h=a.getContext("2d");a.width=r.width,a.height=r.height,h?.drawImage(r,0,0),this.loadBase64Image(a.toDataURL(),i).then(n)},r.crossOrigin="anonymous",r.src=t})}loadBase64Image(t,i){return new Promise((n,o)=>{const r=new Image;r.onload=()=>n({originalImage:r,originalBase64:t}),r.onerror=o,r.src=t}).then(n=>this.transformImageBase64(n,i))}transformImageBase64(t,i){var n=this;return(0,y.Z)(function*(){const o=yield n.autoRotateSupported,r=yield function ie(s){switch("string"==typeof s&&(s=function ne(s){const c=new DataView(function oe(s){s=s.replace(/^data\:([^\;]+)\;base64,/gim,"");const c=atob(s),t=c.length,i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=c.charCodeAt(n);return i.buffer}(s));if(65496!==c.getUint16(0,!1))return-2;const t=c.byteLength;let i=2;for(;i<t;){if(c.getUint16(i+2,!1)<=8)return-1;const n=c.getUint16(i,!1);if(i+=2,65505==n){if(1165519206!==c.getUint32(i+=2,!1))return-1;const o=18761==c.getUint16(i+=6,!1);i+=c.getUint32(i+4,o);const r=c.getUint16(i,o);i+=2;for(let a=0;a<r;a++)if(274==c.getUint16(i+12*a,o))return c.getUint16(i+12*a+8,o)}else{if(65280!=(65280&n))break;i+=c.getUint16(i,!1)}}return-1}(s)),s){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(o?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?n.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:r},i):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(t,i){var n=this;return(0,y.Z)(function*(){const o=i.canvasRotation+t.exifTransform.rotate,r={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===o&&!t.exifTransform.flip&&!i.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:{...r}},transformed:{base64:t.original.base64,image:t.original.image,size:{...r}},exifTransform:t.exifTransform};const a=n.getTransformedSize(r,t.exifTransform,i),h=document.createElement("canvas");h.width=a.width,h.height=a.height;const u=h.getContext("2d");u?.setTransform(t.exifTransform.flip?-1:1,0,0,1,h.width/2,h.height/2),u?.rotate(Math.PI*(o/2)),u?.drawImage(t.original.image,-r.width/2,-r.height/2);const C=h.toDataURL(),f=yield n.loadImageFromBase64(C);return{original:{base64:t.original.base64,image:t.original.image,size:{...r}},transformed:{base64:C,image:f,size:{width:f.width,height:f.height}},exifTransform:t.exifTransform}})()}loadImageFromBase64(t){return new Promise((i,n)=>{const o=new Image;o.onload=()=>i(o),o.onerror=n,o.src=t})}getTransformedSize(t,i,n){const o=n.canvasRotation+i.rotate;if(n.containWithinAspectRatio){if(o%2){const a=t.height/n.aspectRatio;return{width:Math.max(t.height,t.width*n.aspectRatio),height:Math.max(t.width,a)}}{const a=t.width/n.aspectRatio;return{width:Math.max(t.width,t.height*n.aspectRatio),height:Math.max(t.height,a)}}}return o%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ae=(()=>{class s{constructor(t,i,n,o,r){this.cropService=t,this.cropperPositionService=i,this.loadImageService=n,this.sanitizer=o,this.cd=r,this.Hammer=window?.Hammer||null,this.settings=new p,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=_,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new e.EventEmitter,this.startCropImage=new e.EventEmitter,this.imageLoaded=new e.EventEmitter,this.cropperReady=new e.EventEmitter,this.loadImageFailed=new e.EventEmitter,this.transformChange=new e.EventEmitter,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage?.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!t.maintainAspectRatio&&!t.aspectRatio?t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition(),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop(),this.cd.markForCheck()),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){const t=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${t}, ${this.transform.translateV||0}${t}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){!this.loadedImage||(this.hidden?this.resizedWhileHidden=!0:(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()))}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,e.isDevMode)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const i=+t.key;i>=1&&i<=9&&(this.settings.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const n=t.shiftKey?_.Resize:_.Move,o=t.altKey?function g(s){switch(s){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function O(s){switch(s){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),r=function A(s,c){switch(s){case"ArrowUp":return{clientX:0,clientY:-1*c};case"ArrowRight":return{clientX:c,clientY:0};case"ArrowDown":return{clientX:0,clientY:c};default:return{clientX:-1*c,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},n,o),this.moveImg(r),this.moveStop()}startMove(t,i,n=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===_.Pinch||i===_.Drag&&!this.allowMoveImage||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:i,position:n,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper})}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:_.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(t){if(this.moveStart.active){if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===_.Move)this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===_.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===_.Drag){const i=this.cropperPositionService.getClientX(t)-this.moveStart.clientX,n=this.cropperPositionService.getClientY(t)-this.moveStart.clientY;this.transform={...this.transform,translateH:(this.moveStart.transform?.translateH||0)+i,translateV:(this.moveStart.transform?.translateV||0)+n},this.setCssTransform()}this.cd.detectChanges()}}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===_.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===_.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(null!=this.loadedImage?.transformed?.image){this.startCropImage.emit();const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=t&&this.imageCropped.emit(t),t}return null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return s.\u0275fac=function(t){return new(t||s)(e.\u0275\u0275directiveInject(L),e.\u0275\u0275directiveInject(D),e.\u0275\u0275directiveInject(re),e.\u0275\u0275directiveInject(T.H7),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},s.\u0275cmp=e.\u0275\u0275defineComponent({type:s,selectors:[["image-cropper"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(b,7),e.\u0275\u0275viewQuery(R,5)),2&t){let n;e.\u0275\u0275queryRefresh(n=e.\u0275\u0275loadQuery())&&(i.wrapper=n.first),e.\u0275\u0275queryRefresh(n=e.\u0275\u0275loadQuery())&&(i.sourceImage=n.first)}},hostVars:6,hostBindings:function(t,i){1&t&&e.\u0275\u0275listener("resize",function(){return i.onResize()},!1,e.\u0275\u0275resolveWindow)("mousemove",function(o){return i.moveImg(o)},!1,e.\u0275\u0275resolveDocument)("touchmove",function(o){return i.moveImg(o)},!1,e.\u0275\u0275resolveDocument)("mouseup",function(){return i.moveStop()},!1,e.\u0275\u0275resolveDocument)("touchend",function(){return i.moveStop()},!1,e.\u0275\u0275resolveDocument),2&t&&(e.\u0275\u0275styleProp("text-align",i.alignImage),e.\u0275\u0275classProp("disabled",i.disabled)("ngx-ix-hidden",i.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[e.\u0275\u0275NgOnChangesFeature],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load","mousedown","touchstart"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",null,0),e.\u0275\u0275template(2,x,2,7,"img",1),e.\u0275\u0275element(3,"div",2),e.\u0275\u0275template(4,m,3,15,"div",3),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275styleProp("background",i.imageVisible&&i.backgroundColor),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.safeImgDataUrl),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("width",i.maxSize.width,"px")("height",i.maxSize.height,"px")("margin-left","center"===i.alignImage?i.marginLeft:null),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.imageVisible))},dependencies:[v.NgIf],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),s})(),se=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.\u0275\u0275defineNgModule({type:s}),s.\u0275inj=e.\u0275\u0275defineInjector({imports:[[v.CommonModule]]}),s})();function ce(s){const c=s.split(","),t=c[0].replace("data:","").replace(";base64",""),i=atob(c[1]),n=new ArrayBuffer(i.length),o=new Uint8Array(n);for(let r=0;r<i.length;r+=1)o[r]=i.charCodeAt(r);return new Blob([n],{type:t})}}}]);