"use strict";(self.webpackChunkWebAppNew=self.webpackChunkWebAppNew||[]).push([[320],{9320:(Z,O,_)=>{_.r(O),_.d(O,{NewModule:()=>U});var W=_(349),M=_(6895),I=_(1670),l=_(4006),y=_(4537),g=_(5861),d=_(1274),f=_(8259),G=(_(9746),_(9441)),e=_(4650),C=_(6345),T=_(1481),m=_(7753),k=_(7980),$=_(5219),N=_(7513);const x=["contentsOrdenables"],F=["previewModal"],D=["acdcDatepicker"];function K(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",50),e.\u0275\u0275i18n(1,51),e.\u0275\u0275elementEnd())}function L(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",50),e.\u0275\u0275i18n(1,52),e.\u0275\u0275elementEnd())}function X(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",50),e.\u0275\u0275i18n(1,53),e.\u0275\u0275elementEnd())}let z=(()=>{class r{constructor(t,n,o,i,a){this.main=t,this.fb=n,this.domSanitizer=o,this.modalService=i,this.location=a,this.selectedAuthor="2",this.processingFiles=!1,this.files=[],this.validate=!1,this.carregantBotoPublicar=!1,this.mostrarFileRequired=!1,t.newPage(this),this.form=this.fb.group({inputFiles:["",l.kI.required],title:["",l.kI.required],author:[""],authorType:["",l.kI.required],date:[""],mediums:[""],otherMediums:[""],movements:[""],otherMovements:[""],dimensions:[""],technique:[""],price:[""],currency:[""],description:["",l.kI.required],tags:[""],major18:[!1]})}ngOnInit(){return(0,g.Z)(function*(){})()}ngOnDestroy(){this.closePreviewModal(),this.main.onDestroyPage()}close(){this.location.back()}addFiles(){var t=this;return(0,g.Z)(function*(){t.processingFiles=!0;let n=0,o=f(".inputFile")[0].files;for(let i=0;i<o.length;i++){let a=o[i];a&&(a.blob=t.domSanitizer.bypassSecurityTrustUrl(yield d.c.blobToBase64(a)),t.contentsOrdenables.items.push(a),n++,n==o.length&&(f(".inputFile").val(""),t.processingFiles=!1))}})()}othersSeleccionat(t){return t.includes(-1)||t.includes("-1")}corregirTags(){let t=this.form.controls.tags.value;t=t.split(/[\s,]+/).map(n=>d.c.parseTag(n)).filter(n=>n.length).join(", "),this.form.controls.tags.setValue(t)}focusInputAuthor(){f("#at_authorName").prop("checked",!0),f("#author").trigger("focus"),this.form.controls.authorType.setValue("3")}cancelNewArtwork(){var t=this;return(0,g.Z)(function*(){t.main.goToProfile()})()}openPreviewModal(){var t=this;return(0,g.Z)(function*(){t.modalService.open(t.previewModal,{size:"xl",modalClass:"previewModal",backdropClass:"modal-backdrop",hideCloseButton:!0,centered:!0,backdrop:!0,animation:!0,keyboard:!0,closeOnOutsideClick:!1})})()}closePreviewModal(){var t=this;return(0,g.Z)(function*(){try{t.modalService.close(t.previewModal)}catch{}yield d.c.wait(.5),t.preview=null})()}submit(){var t=this;return(0,g.Z)(function*(){if(t.form.markAllAsTouched(),t.acdcDatepicker.touched=!0,t.mostrarFileRequired=!d.c.objPle(t.files),t.corregirTags(),!d.c.objPle(t.files)||!t.form.valid||!t.acdcDatepicker.isValid())return console.log("--- INV\xc0LID ---"),void console.log(t.form);let n="";"y"==t.acdcDatepicker.type&&(n=yield t.acdcDatepicker.getTextAny()),"c"==t.acdcDatepicker.type&&(n=t.acdcDatepicker.getTextSegle().split(" (")[0]);let o=t.form.controls.price.value;o&&(o=o.toFixed(2)+"\u20ac"),t.preview={content:t.contentsOrdenables.getItemsOrdered(),title:t.form.controls.title.value,author:t.form.controls.author.value,dateMaco:n,dimensions:t.form.controls.dimensions.value,description:t.form.controls.description.value,self:t.main.currentUser},console.log("Info from preview: ",t.preview),console.log("--- V\xc0LID ---")})()}dateFormatType(){let t;switch(this.acdcDatepicker.type){case"y":t="Date";break;case"c":t="Roman";break;case"u":t="Unknown"}return t}isMissingSomething(){const t=this.form.get("title"),n=this.form.get("description");return!t?.valid||!n?.valid}publicar(){var t=this;return(0,g.Z)(function*(){t.submit(),t.carregantBotoPublicar=!0;const n=new FormData;n.append("title",t.form.controls.title.value),n.append("authorType",t.form.controls.authorType.value),n.append("date",JSON.stringify(t.acdcDatepicker.getObjData())),n.append("description",t.form.controls.description.value);let o=t.contentsOrdenables.getItemsOrdered();t.base64Info=o[0].blob.changingThisBreaksApplicationSecurity,console.log("Base64: ",t.base64Info);let i={files:[{fileExt:t.findFileExtension(t.base64Info),dataBase64:t.base64Info,data:null}],languages:[{title:t.form.controls.title.value,description:t.form.controls.description.value,langCode:"en-uk"}]},a=t.acdcDatepicker.boolToAcdc("c"==t.acdcDatepicker.type),u={post:i,date:n.get("date").toString(),price:null,dateFormatType:t.dateFormatType(),afterChrist:"d.C."==a,isArtistUser:"1"==t.selectedAuthor,languages:[{langCode:"en-uk"}]};yield G.iB.post(u).then(P=>{200==P.status&&(t.main.toastSuccess("Artwork publicada correctament"),t.main.goToProfile())})})()}findFileExtension(t){const n="data:image/",o=t.indexOf(n);if(-1!==o){const i=t.indexOf(";",o);if(-1!==i){const a=t.substring(o+n.length,i);return console.log("Extension: ",a),a}}return null}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(C.J),e.\u0275\u0275directiveInject(l.qu),e.\u0275\u0275directiveInject(T.H7),e.\u0275\u0275directiveInject(m.gk),e.\u0275\u0275directiveInject(M.Location))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-new-artwork"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(x,5),e.\u0275\u0275viewQuery(F,5),e.\u0275\u0275viewQuery(D,5)),2&t){let o;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(n.contentsOrdenables=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(n.previewModal=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(n.acdcDatepicker=o.first)}},decls:66,vars:12,consts:function(){let s,t,n,o,i,a,u,P,p,A,R,S,h,b,v,w;return s="Aix\xF2 nom\xE9s \xE9s per a obres acabades que seran avaluades. Si us plau no pengis un altre tipus de contingut.",t="Arrossega per a ordenar",n="Pots pujar: fotos (.JPG, .PNG, .GIF) i v\xEDdeos (.MP4, .AVI) ",o="T\xEDtol",i="Autor",a="Jo mateix",u="Desconegut",P="Data",p="Dimensions (amplada, altura, profunditat)",A="Descripci\xF3",R="Tanca",S="Enrere",h="Publica",b="El t\xEDtol \xE9s obligatori",v="L'autor \xE9s obligatori",w="La data \xE9s obligat\xF2ria",[[1,"content"],[1,"card"],[1,"card-body"],[1,"content-header"],[1,"notaEnGris"],s,["type","button","aria-label","Close",1,"close","ng-star-inserted"],["aria-hidden","true",3,"click"],[1,"theme-form",3,"formGroup"],["type","file","multiple","","accept",".JPG,.PNG,.GIF,.MP4,.AVI,.MP3,.WAV,.OGG",1,"form-camp","inputFile",3,"disabled","input"],[1,"divContentsOrdenables","clearfix"],[1,"notaEnGris","dragToOrder"],t,["contentsOrdenables",""],n,[1,"form-grup","row","no-gutters"],[1,"col-form-label","col-sm-12","col-xl-3","asterisc"],o,["type","text","formControlName","title",1,"form-camp","col-sm-12","col-xl-9"],["class","textErrorForm",4,"ngIf"],i,[1,"col-sm-12","col-xl-9","m-checkbox-inline"],[1,"grupCadaRadio",2,"min-width","20%"],[1,"radio","radio-primary"],["id","at_myself","type","radio","value","1","name","authorType","formControlName","authorType",3,"ngModel","ngModelChange"],["for","at_myself"],a,["id","at_unknown","type","radio","value","2","name","authorType","formControlName","authorType",3,"ngModel","ngModelChange"],["for","at_unknown"],u,[3,"nomText","control"],P,[1,"col-sm-12","col-xl-9"],["acdcDatepicker",""],[1,"col-form-label","col-sm-12","col-xl-3"],p,["type","text","formControlName","dimensions",1,"form-camp","col-sm-12","col-xl-9"],A,["maxlength","3000","formControlName","description",1,"form-camp","col-sm-12","col-xl-9"],[2,"text-align","center"],["id","cancel",1,"boto","botoPrincipal","botoGran",3,"click"],R,["type","button","value","Post",1,"boto","botoPrincipal","botoGran",3,"disabled","click"],["id","previewModal"],["previewModal",""],[1,"botons"],[1,"boto","botoPrincipal","botoGran","back",3,"click"],S,[1,"boto","botoPrincipal","botoGran","post",3,"disabled","click"],h,[1,"textErrorForm"],b,v,w]},template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),e.\u0275\u0275i18n(5,5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",6)(7,"span",7),e.\u0275\u0275listener("click",function(){return n.close()}),e.\u0275\u0275text(8,"\xd7"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(9,"form",8)(10,"input",9),e.\u0275\u0275listener("input",function(){return n.addFiles()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",10)(12,"p",11),e.\u0275\u0275i18n(13,12),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"app-contents-ordenables",null,13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"p",4),e.\u0275\u0275i18n(17,14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",15)(19,"label",16),e.\u0275\u0275i18n(20,17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"input",18),e.\u0275\u0275template(22,K,2,0,"div",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"div",15)(24,"label",16),e.\u0275\u0275i18n(25,20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"div",21)(27,"div",22)(28,"div",23)(29,"input",24),e.\u0275\u0275listener("ngModelChange",function(i){return n.selectedAuthor=i}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"label",25),e.\u0275\u0275i18n(31,26),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(32,"div",22)(33,"div",23)(34,"input",27),e.\u0275\u0275listener("ngModelChange",function(i){return n.selectedAuthor=i}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"label",28),e.\u0275\u0275i18n(36,29),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(37,"app-missatge-error-form",30),e.\u0275\u0275listener("control",function(){return n.form.controls.authorType}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(38,L,2,0,"div",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"div",15)(40,"label",16),e.\u0275\u0275i18n(41,31),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(42,"app-acdc-datepicker",32,33),e.\u0275\u0275template(44,X,2,0,"div",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"div",15)(46,"label",34),e.\u0275\u0275i18n(47,35),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(48,"input",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"div",15)(50,"label",16),e.\u0275\u0275i18n(51,37),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(52,"textarea",38),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(53,"div",39)(54,"button",40),e.\u0275\u0275listener("click",function(){return n.cancelNewArtwork()}),e.\u0275\u0275i18n(55,41),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(56,"input",42),e.\u0275\u0275listener("click",function(){return n.publicar()}),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(57,"modal",43,44),e.\u0275\u0275element(59,"modal-content"),e.\u0275\u0275elementStart(60,"modal-footer")(61,"div",45)(62,"button",46),e.\u0275\u0275listener("click",function(){return n.closePreviewModal()}),e.\u0275\u0275i18n(63,47),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(64,"button",48),e.\u0275\u0275listener("click",function(){return n.publicar()}),e.\u0275\u0275i18n(65,49),e.\u0275\u0275elementEnd()()()()),2&t){const o=e.\u0275\u0275reference(15),i=e.\u0275\u0275reference(43);e.\u0275\u0275advance(9),e.\u0275\u0275property("formGroup",n.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",n.processingFiles),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("display",o.items.length?"block":"none"),e.\u0275\u0275advance(11),e.\u0275\u0275property("ngIf",n.form.controls.title.touched&&(null==n.form.controls.title.errors?null:n.form.controls.title.errors.required)),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngModel",n.selectedAuthor),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",n.selectedAuthor),e.\u0275\u0275advance(3),e.\u0275\u0275property("nomText","author"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",3==n.form.controls.authorType.value&&""==n.form.controls.author.value),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",i.touched&&!i.isValid()),e.\u0275\u0275advance(12),e.\u0275\u0275property("disabled",!o.items.length),e.\u0275\u0275advance(8),e.\u0275\u0275property("disabled",n.carregantBotoPublicar)}},dependencies:[M.NgIf,l._Y,l.Fj,l._,l.JJ,l.JL,l.nD,l.sg,l.u,k.o,$.T,N.D,m.zS,m.YI,m.Ef],styles:[".content[_ngcontent-%COMP%]{max-width:940px;padding:100px 0;border:none}.content[_ngcontent-%COMP%]   .content-top[_ngcontent-%COMP%]{margin-bottom:20px}.content[_ngcontent-%COMP%]   .content-top[_ngcontent-%COMP%]   .titol[_ngcontent-%COMP%]{font-size:2rem;text-align:center}.content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#222;border:none}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputFile[_ngcontent-%COMP%]{padding:6px;margin-bottom:1.5rem;border-radius:25px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputFile[_ngcontent-%COMP%]::-webkit-file-upload-button{border-radius:25px;border:var(--border-input)}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]{margin-bottom:1.5rem}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]   .dragToOrder[_ngcontent-%COMP%]{margin-bottom:0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]   app-contents-ordenables[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{margin:0 -1%}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .notaEnGris[_ngcontent-%COMP%]{margin-bottom:1.5rem}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   label.col-form-label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0;padding:7px 0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   div.radio[_ngcontent-%COMP%]{margin:auto 0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .form-camp[_ngcontent-%COMP%]{padding:6px 12px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .grupCadaRadio[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .grupCadaRadio[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{padding-left:3px;display:inline-flex;margin:5px 0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .grupCadaRadio[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:0;padding:0 10px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   app-acdc-datepicker[_ngcontent-%COMP%]{padding:0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]     ng-select{padding-right:0;padding-left:0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]     ng-select ng-dropdown-panel{background-color:var(--color-fons-card-2);color:var(--color-text)}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]     ng-select ng-dropdown-panel .ng-option{background-color:transparent;color:inherit}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]     ng-select ng-dropdown-panel .ng-option.ng-option-marked{background-color:#09f4}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{overflow:hidden;min-height:100px;max-height:300px;font-size:14px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar{width:0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:after{transform:scale(1.2)}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:before{border:1px solid #222}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:after{transition:transform .2s ease-in}.content[_ngcontent-%COMP%]   #cancel[_ngcontent-%COMP%]{margin-right:10px}  .form-grup ng-select .ng-select-container{border:var(--border-input)}  .form-grup ng-select .ng-arrow{border-top-color:var(--color-text)}  .form-grup ng-select .ng-select-opened .ng-arrow{border-bottom-color:var(--color-text)}  .form-grup ng-select ng-dropdown-panel{overflow:hidden}[_nghost-%COMP%]     #previewModal .modal-content{overflow:hidden;border:none;border-radius:0;background:transparent}[_nghost-%COMP%]     #previewModal .modal-content .modal-header{display:none}[_nghost-%COMP%]     #previewModal .modal-content .modal-body{padding:0}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer{border:none}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer{width:100%}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons{text-align:center}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons button.back, [_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons button.post{margin:0 3%;width:40%;padding:8px 0}.row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-shrink:initial}@media only screen and (max-width: 576px){.titol[_ngcontent-%COMP%]{margin-top:.5rem}.anarAPost[_ngcontent-%COMP%]{margin-left:50%}}"]}),r})();var j=_(5585);const B=["contentsOrdenables"],V=["previewModal"];function J(r,s){if(1&r&&e.\u0275\u0275element(0,"app-publicacio",37),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("p",t.preview)("preview",!0)}}let q=(()=>{class r{constructor(t,n,o,i){this.main=t,this.fb=n,this.domSanitizer=o,this.modalService=i,this.processingFiles=!1,this.files=[],this.validate=!1,this.carregantBotoPublicar=!1,this.mostrarFileRequired=!1,t.newPage(this),this.form=this.fb.group({inputFiles:[""],description:[""],tags:[""],major18:[!1]})}ngOnInit(){return(0,g.Z)(function*(){})()}ngOnDestroy(){this.closePreviewModal(),this.main.onDestroyPage()}addFiles(){var t=this;return(0,g.Z)(function*(){t.processingFiles=!0;let n=0,o=f(".inputFile")[0].files;for(let i=0;i<o.length;i++){let a=o[i];a&&(a.blob=t.domSanitizer.bypassSecurityTrustUrl(yield d.c.blobToBase64(a)),t.contentsOrdenables.items.push(a),n++,n==o.length&&(f(".inputFile").val(""),t.processingFiles=!1))}})()}corregirTags(){let t=this.form.controls.tags.value;t=t.split(/[\s,]+/).map(n=>d.c.parseTag(n)).filter(n=>n.length).join(", "),this.form.controls.tags.setValue(t)}openPreviewModal(){var t=this;return(0,g.Z)(function*(){t.modalService.open(t.previewModal,{size:"xl",modalClass:"previewModal",backdropClass:"modal-backdrop",hideCloseButton:!0,centered:!0,backdrop:!0,animation:!0,keyboard:!0,closeOnOutsideClick:!1})})()}closePreviewModal(){var t=this;return(0,g.Z)(function*(){try{t.modalService.close(t.previewModal)}catch{}yield d.c.wait(.5),t.preview=null})()}submit(){if(this.form.markAllAsTouched(),this.mostrarFileRequired=!d.c.objPle(this.files),this.corregirTags(),!d.c.objPle(this.files)||!this.form.valid)return console.log("--- INV\xc0LID ---"),void console.log(this.form);this.preview={content:this.contentsOrdenables.getItemsOrdered(),description:this.form.controls.description.value,tags:this.form.controls.tags.value,major18:this.form.controls.major18.value,esObra:!1},console.log(this.form),console.log("--- V\xc0LID ---"),this.preview.tags=this.preview.tags.split(", ").filter(t=>t).map(t=>({text:t})),this.preview.user=this.main.currentUser,this.openPreviewModal()}publicar(){this.carregantBotoPublicar=!0;const t=new FormData;this.preview.content.forEach((n,o)=>{t.append(`content[${o}][type]`,n.type),t.append(`content[${o}][order]`,o),t.append(`content[${o}][text]`,"");var i=new File([d.c.dataURLToBlob(n.blob.changingThisBreaksApplicationSecurity)],"photo.png");t.append(`content[${o}][file]`,i,"photo.png")}),t.append("text_post",this.preview.description),this.preview.tags.forEach(n=>{t.append("tags[]",n.text)}),t.append("major18",this.preview.major18?"1":"0"),d.c.showFormData(t)}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(C.J),e.\u0275\u0275directiveInject(l.qu),e.\u0275\u0275directiveInject(T.H7),e.\u0275\u0275directiveInject(m.gk))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-new-post"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(B,5),e.\u0275\u0275viewQuery(V,5)),2&t){let o;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(n.contentsOrdenables=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(n.previewModal=o.first)}},decls:43,vars:7,consts:function(){let s,t,n,o,i,a,u,P;return s="Nova publicaci\xF3",t="Ves a nova obra d'art " + "\ufffd#9\ufffd" + "" + "\ufffd/#9\ufffd" + "",n="Arrossega per a ordenar",o="Pots pujar: fotos (.JPG, .PNG, .GIF) i v\xEDdeos (.MP4, .AVI) ",i="Descripci\xF3",a="Etiquetes",u="Enrere",P="Publica",[[1,"content"],[1,"card"],[1,"card-body"],[1,"content-top","row","no-gutters"],[1,"col-sm-3","col-12"],[1,"col-sm-6","col-12","order-2","order-sm-1","titol"],s,[1,"col-sm-3","col-12","order-1","order-sm-2","boto","botoSecundari","anarAArtwork",3,"click"],t,[1,"fas","fa-chevron-right"],[1,"theme-form",3,"formGroup"],["type","file","multiple","","accept",".JPG,.PNG,.GIF,.MP4,.AVI,.MP3,.WAV,.OGG",1,"form-camp","inputFile",3,"disabled","input"],[1,"divContentsOrdenables","clearfix"],[1,"notaEnGris","dragToOrder"],n,["contentsOrdenables",""],[1,"notaEnGris"],o,[1,"form-grup","row","no-gutters"],[1,"col-form-label","col-sm-12","col-xl-3"],i,["maxlength","3000","formControlName","description",1,"form-camp","col-sm-12","col-xl-9"],a,["type","text","formControlName","tags",1,"form-camp","col-sm-12","col-xl-9",3,"blur"],[1,"form-grup"],["for","major18",1,"d-block","checkbox-label",2,"text-align","center"],["id","major18","type","checkbox","formControlName","major18",1,"checkbox_animated"],[2,"text-align","center"],["type","button","value","Save",1,"boto","botoPrincipal","botoGran",3,"disabled","click"],["id","previewModal"],["previewModal",""],[3,"p","preview",4,"ngIf"],[1,"botons"],[1,"boto","botoPrincipal","botoGran","back",3,"click"],u,[1,"boto","botoPrincipal","botoGran","post",3,"disabled","click"],P,[3,"p","preview"]]},template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.\u0275\u0275element(4,"div",4),e.\u0275\u0275elementStart(5,"div",5),e.\u0275\u0275i18n(6,6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",7),e.\u0275\u0275listener("click",function(){return n.main.goTo("new/artwork")}),e.\u0275\u0275i18nStart(8,8),e.\u0275\u0275element(9,"i",9),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"form",10)(11,"input",11),e.\u0275\u0275listener("input",function(){return n.addFiles()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",12)(13,"p",13),e.\u0275\u0275i18n(14,14),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(15,"app-contents-ordenables",null,15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"p",16),e.\u0275\u0275i18n(18,17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",18)(20,"label",19),e.\u0275\u0275i18n(21,20),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(22,"textarea",21),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"div",18)(24,"label",19),e.\u0275\u0275i18n(25,22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"input",23),e.\u0275\u0275listener("blur",function(){return n.corregirTags()}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"div",24)(28,"label",25),e.\u0275\u0275element(29,"input",26),e.\u0275\u0275text(30,"The content uploaded is only for 18+ "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"div",27)(32,"input",28),e.\u0275\u0275listener("click",function(){return n.submit()}),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(33,"modal",29,30)(35,"modal-content"),e.\u0275\u0275template(36,J,1,2,"app-publicacio",31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"modal-footer")(38,"div",32)(39,"button",33),e.\u0275\u0275listener("click",function(){return n.closePreviewModal()}),e.\u0275\u0275i18n(40,34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(41,"button",35),e.\u0275\u0275listener("click",function(){return n.publicar()}),e.\u0275\u0275i18n(42,36),e.\u0275\u0275elementEnd()()()()),2&t){const o=e.\u0275\u0275reference(16);e.\u0275\u0275advance(10),e.\u0275\u0275property("formGroup",n.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",n.processingFiles),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("display",o.items.length?"block":"none"),e.\u0275\u0275advance(20),e.\u0275\u0275property("disabled",!o.items.length),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",n.preview),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",n.carregantBotoPublicar)}},dependencies:[M.NgIf,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.nD,l.sg,l.u,j.u,N.D,m.zS,m.YI,m.Ef],styles:[".content[_ngcontent-%COMP%]{max-width:940px;padding:100px 0;border:none}.content[_ngcontent-%COMP%]   .content-top[_ngcontent-%COMP%]{margin-bottom:20px}.content[_ngcontent-%COMP%]   .content-top[_ngcontent-%COMP%]   .titol[_ngcontent-%COMP%]{font-size:2rem;text-align:center}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputFile[_ngcontent-%COMP%]{padding:6px;margin-bottom:1.5rem;border-radius:25px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputFile[_ngcontent-%COMP%]::-webkit-file-upload-button{border-radius:25px;border:var(--border-input)}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]{margin-bottom:1.5rem}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]   .dragToOrder[_ngcontent-%COMP%]{margin-bottom:0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divContentsOrdenables[_ngcontent-%COMP%]   app-contents-ordenables[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{margin:0 -1%}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .notaEnGris[_ngcontent-%COMP%]{margin-bottom:1.5rem}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   label.col-form-label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0;padding:7px 0}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .form-camp[_ngcontent-%COMP%]{padding:6px 12px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:100px;max-height:300px;font-size:14px}.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar{width:0}[_nghost-%COMP%]     #previewModal .modal-content{overflow:hidden;border:none;border-radius:0;background:transparent}[_nghost-%COMP%]     #previewModal .modal-content .modal-header{display:none}[_nghost-%COMP%]     #previewModal .modal-content .modal-body{padding:0}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer{border:none}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer{width:100%}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons{text-align:center}[_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons button.back, [_nghost-%COMP%]     #previewModal .modal-content .modal-footer modal-footer .botons button.post{margin:0 3%;width:40%;padding:8px 0}.row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-shrink:initial}@media only screen and (max-width: 576px){.titol[_ngcontent-%COMP%]{margin-top:.5rem}.anarAArtwork[_ngcontent-%COMP%]{margin-left:50%}}"]}),r})();var E=_(4270);const Q=[{path:"",children:[{path:"",redirectTo:"artwork",pathMatch:"full"},{path:"artwork",component:z},{path:"post",component:q}]}];let Y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[E.Bz.forChild(Q),E.Bz]}),r})(),U=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[Y,M.CommonModule,I.m,l.u5,y.A0,W.qE,m.zk]}),r})()}}]);