(self.webpackChunkcuba=self.webpackChunkcuba||[]).push([[646],{4646:function(e,t,o){"use strict";o.r(t),o.d(t,{EditProfileModule:function(){return y}});var n=o(1116),r=o(8826),l=o(1041),a=o(4762),i=o(8816),c=o(5366),m=o(2927),d=o(5703),s=o(9624),p=o(4405),f=o(1027),h=o(5641);const u=["uploadFileModal"],b=["imageCropper"];function g(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"button",51),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"](2).removePhoto()}),c["\u0275\u0275i18n"](1,52),c["\u0275\u0275elementEnd"]()}}function v(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",53),c["\u0275\u0275i18n"](1,54),c["\u0275\u0275elementEnd"]())}function x(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"form",12),c["\u0275\u0275elementStart"](1,"div",13),c["\u0275\u0275elementStart"](2,"button",14),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().openUploadFileModal()}),c["\u0275\u0275element"](3,"img",15),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](4,"br"),c["\u0275\u0275template"](5,g,2,0,"button",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"div",17),c["\u0275\u0275elementStart"](7,"label",18),c["\u0275\u0275i18n"](8,19),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](9,"input",20),c["\u0275\u0275element"](10,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"div",17),c["\u0275\u0275elementStart"](12,"label",22),c["\u0275\u0275i18n"](13,23),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](14,"input",24),c["\u0275\u0275element"](15,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](16,"div",17),c["\u0275\u0275elementStart"](17,"label",22),c["\u0275\u0275i18n"](18,25),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](19,"input",26),c["\u0275\u0275element"](20,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](21,"div",17),c["\u0275\u0275elementStart"](22,"label",27),c["\u0275\u0275i18n"](23,28),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](24,"div",29),c["\u0275\u0275elementStart"](25,"label",30),c["\u0275\u0275element"](26,"input",31),c["\u0275\u0275text"](27,"Artist "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](28,"label",32),c["\u0275\u0275element"](29,"input",33),c["\u0275\u0275text"](30,"Professional "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](31,"label",34),c["\u0275\u0275element"](32,"input",35),c["\u0275\u0275text"](33,"Collector "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](34,"label",36),c["\u0275\u0275element"](35,"input",37),c["\u0275\u0275text"](36,"Viewer "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](37,v,2,0,"div",38),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](38,"div",17),c["\u0275\u0275elementStart"](39,"label",22),c["\u0275\u0275i18n"](40,39),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](41,"input",40),c["\u0275\u0275element"](42,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](43,"div",17),c["\u0275\u0275elementStart"](44,"label",22),c["\u0275\u0275i18n"](45,41),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](46,"input",42),c["\u0275\u0275element"](47,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](48,"div",17),c["\u0275\u0275elementStart"](49,"label",22),c["\u0275\u0275i18n"](50,43),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](51,"input",44),c["\u0275\u0275element"](52,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](53,"div",17),c["\u0275\u0275elementStart"](54,"label",22),c["\u0275\u0275i18n"](55,45),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](56,"input",46),c["\u0275\u0275element"](57,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](58,"div",17),c["\u0275\u0275elementStart"](59,"label",22),c["\u0275\u0275i18n"](60,47),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](61,"input",48),c["\u0275\u0275element"](62,"app-missatge-error-form",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](63,"div",49),c["\u0275\u0275elementStart"](64,"input",50),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().submit()}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("formGroup",e.form),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("src",e.form.controls.photo.value,c["\u0275\u0275sanitizeUrl"]),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",e.form.controls.photo.value),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.name)("nomText","name"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.lastName)("nomText","last name"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.bio)("nomText","bio"),c["\u0275\u0275advance"](17),c["\u0275\u0275property"]("ngIf",e.profileIncorrecte()),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.email)("nomText","email"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.username)("nomText","username"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.phone)("nomText","phone"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.address)("nomText","address"),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("control",e.form.controls.web)("nomText","website"),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("disabled",e.carregantSave)}}function C(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",55),c["\u0275\u0275element"](1,"app-loading"),c["\u0275\u0275elementEnd"]())}let P=(()=>{class e{constructor(e,t,o,n){this.main=e,this.fb=t,this.modalService=o,this.domSanitizer=n,this.files=[],this.validate=!1,this.fotoModificada=!1,this.mostrarFileRequired=!1,e.newPage(this),this.form=this.fb.group({id:[""],photo:[""],name:["",l.kI.required],lastName:[""],bio:[""],profile1:[!1],profile2:[!1],profile3:[!1],profile4:[!1],email:[""],username:[""],phone:[""],address:[""],web:[""]})}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){this.carregant=!0;let e=yield this.main.provider.getCurrentUser();this.carregant=!1,this.form.controls.photo.setValue(e.photo),this.form.controls.name.setValue(e.name),this.form.controls.lastName.setValue(e.lastName),this.form.controls.bio.setValue(e.bio||""),this.form.controls.email.setValue(e.email||""),this.form.controls.username.setValue(e.username||""),this.form.controls.phone.setValue(e.phone||""),this.form.controls.address.setValue(e.address||""),this.form.controls.web.setValue(e.web||"");let t=[];e.profile.forEach(e=>{t[e.idprofile]=!0}),this.form.controls.profile1.setValue(t[1]),this.form.controls.profile2.setValue(t[2]),this.form.controls.profile3.setValue(t[3]),this.form.controls.profile4.setValue(t[4])})}ngOnDestroy(){this.closeUploadFileModal(!1),this.main.onDestroyPage()}openUploadFileModal(){this.modalService.open(this.uploadFileModal,{size:"lg",modalClass:"uploadFileModal",backdropClass:"modal-backdrop",hideCloseButton:!1,centered:!0,backdrop:!0,animation:!0,keyboard:!0,closeOnOutsideClick:!1})}closeUploadFileModal(e){e&&(this.form.controls.photo.setValue(this.imageCropper.croppedImage),this.fotoModificada=!0),this.modalService.close(this.uploadFileModal)}removePhoto(){this.form.controls.photo.setValue(null),this.imageCropper.removePhoto(),this.fotoModificada=!0}profileIncorrecte(){return(this.form.controls.profile1.touched||this.form.controls.profile2.touched||this.form.controls.profile3.touched||this.form.controls.profile4.touched)&&!(this.form.controls.profile1.value||this.form.controls.profile2.value||this.form.controls.profile3.value||this.form.controls.profile4.value)}submit(){if(this.form.markAllAsTouched(),this.mostrarFileRequired=!i.c.objPle(this.files),!this.form.valid||this.profileIncorrecte())return console.log("--- INV\xc0LID ---"),void console.log(this.form);const e=new FormData;if(this.fotoModificada)if(this.form.controls.photo.value){var t=new File([i.c.dataURLToBlob(this.form.controls.photo.value)],"photo.png");e.append("photo",t,"photo.png")}else e.append("photoDelete","");e.append("name",this.form.controls.name.value),e.append("lastName",this.form.controls.lastName.value),e.append("bio",this.form.controls.bio.value),e.append("phone",this.form.controls.phone.value),e.append("address",this.form.controls.address.value),e.append("web",this.form.controls.web.value),this.form.controls.profile1.value&&e.append("profile[]","1"),this.form.controls.profile2.value&&e.append("profile[]","2"),this.form.controls.profile3.value&&e.append("profile[]","3"),this.form.controls.profile4.value&&e.append("profile[]","4"),this.carregantSave=!0,this.main.ps.postFormData("/editProfile",e,e=>{this.carregantSave=!1,this.main.eh.hiHaError(e)?this.main.toastDanger("Couldn't edit profile"):(this.main.refreshCurrentUser(),this.main.toastSuccess("Profile modified successfully"),this.main.goTo("/profile"))})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](m.J),c["\u0275\u0275directiveInject"](l.qu),c["\u0275\u0275directiveInject"](d.gk),c["\u0275\u0275directiveInject"](s.H7))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit-profile"]],viewQuery:function(e,t){if(1&e&&(c["\u0275\u0275viewQuery"](u,5),c["\u0275\u0275viewQuery"](b,5)),2&e){let e;c["\u0275\u0275queryRefresh"](e=c["\u0275\u0275loadQuery"]())&&(t.uploadFileModal=e.first),c["\u0275\u0275queryRefresh"](e=c["\u0275\u0275loadQuery"]())&&(t.imageCropper=e.first)}},decls:17,vars:2,consts:function(){let e,t,o,n,r,l,a,i,c,m,d,s,p,f;return e="Subir foto",t="Cerrar",o="Guardar",n="Nombre",r="Apellidos",l="Biograf\xEDa",a="Perfil",i="Correo electr\xF3nico",c="Nombre de usuario",m="Tel\xE9fono",d="Direcci\xF3n",s="P\xE1gina web",p="Elimina foto",f="El perfil es obligatorio",[[1,"content"],[1,"card"],[1,"card-body"],["class","theme-form",3,"formGroup",4,"ngIf"],["class","carregant",4,"ngIf"],["id","uploadFileModal",1,"uploadFileModal"],["uploadFileModal",""],e,["imageCropper",""],[1,"boto","botoPrincipal","botoGran",3,"click"],t,o,[1,"theme-form",3,"formGroup"],[1,"divBotoFoto","form-grup"],["data-content","Change photo",1,"botoFoto",3,"click"],["alt","profile photo",1,"foto",3,"src"],["class","boto botoVermell botoPetit removePhoto",3,"click",4,"ngIf"],[1,"form-grup","row","no-gutters"],[1,"col-form-label","col-sm-12","col-xl-3","asterisc"],n,["type","text","formControlName","name",1,"form-camp","col-sm-12","col-xl-9"],[3,"control","nomText"],[1,"col-form-label","col-sm-12","col-xl-3"],r,["type","text","formControlName","lastName",1,"form-camp","col-sm-12","col-xl-9"],l,["type","text","maxlength","3000","formControlName","bio",1,"form-camp","col-sm-12","col-xl-9"],[1,"col-form-label","col-12","col-sm-3","asterisc"],a,[1,"col-12","col-sm-9","animate-chk","row","no-gutters"],["for","checkbox1",1,"d-block","checkbox-label","col-12","col-sm-6","col-md-3"],["id","checkbox1","type","checkbox","formControlName","profile1",1,"checkbox_animated"],["for","checkbox2",1,"d-block","checkbox-label","col-12","col-sm-6","col-md-3"],["id","checkbox2","type","checkbox","formControlName","profile2",1,"checkbox_animated"],["for","checkbox3",1,"d-block","checkbox-label","col-12","col-sm-6","col-md-3"],["id","checkbox3","type","checkbox","formControlName","profile3",1,"checkbox_animated"],["for","checkbox4",1,"d-block","checkbox-label","col-12","col-sm-6","col-md-3"],["id","checkbox4","type","checkbox","formControlName","profile4",1,"checkbox_animated"],["class","textErrorForm",4,"ngIf"],i,["type","text","disabled","","formControlName","email",1,"form-camp","col-sm-12","col-xl-9"],c,["type","text","disabled","","formControlName","username",1,"form-camp","col-sm-12","col-xl-9"],m,["type","text","formControlName","phone",1,"form-camp","col-sm-12","col-xl-9"],d,["type","text","formControlName","address",1,"form-camp","col-sm-12","col-xl-9"],s,["type","text","formControlName","web",1,"form-camp","col-sm-12","col-xl-9"],[2,"text-align","center"],["type","button","value","Save",1,"boto","botoPrincipal","botoGran",3,"disabled","click"],[1,"boto","botoVermell","botoPetit","removePhoto",3,"click"],p,[1,"textErrorForm"],f,[1,"carregant"]]},template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",0),c["\u0275\u0275elementStart"](1,"div",1),c["\u0275\u0275elementStart"](2,"div",2),c["\u0275\u0275template"](3,x,65,21,"form",3),c["\u0275\u0275template"](4,C,2,0,"div",4),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"modal",5,6),c["\u0275\u0275elementStart"](7,"modal-header"),c["\u0275\u0275i18n"](8,7),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"modal-content"),c["\u0275\u0275element"](10,"app-image-croper",null,8),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](12,"modal-footer"),c["\u0275\u0275elementStart"](13,"button",9),c["\u0275\u0275listener"]("click",function(){return t.closeUploadFileModal(!1)}),c["\u0275\u0275i18n"](14,10),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"button",9),c["\u0275\u0275listener"]("click",function(){return t.closeUploadFileModal(!0)}),c["\u0275\u0275i18n"](16,11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",!t.carregant),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",t.carregant))},directives:[n.NgIf,d.zS,d.Rb,d.Ef,p.r,d.YI,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,f.T,l.nD,l.Wl,h.N],styles:[".content[_ngcontent-%COMP%]{max-width:940px;padding:100px 0;border:none}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-radius:40px}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divBotoFoto[_ngcontent-%COMP%]{text-align:center}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divBotoFoto[_ngcontent-%COMP%]   button.botoFoto[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:cover;object-fit:cover;padding:0;margin-bottom:10px;border:none;border-radius:10000px;overflow:hidden;position:relative}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divBotoFoto[_ngcontent-%COMP%]   button.botoFoto[_ngcontent-%COMP%]:after{content:attr(data-content);font-size:20px;line-height:150px;color:#fff;position:absolute;width:100%;height:100%;top:0;left:0;background-color:#0008;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);opacity:0;border-radius:10000px;transition:all .2s}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divBotoFoto[_ngcontent-%COMP%]   button.botoFoto[_ngcontent-%COMP%]:hover:after{opacity:1}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .divBotoFoto[_ngcontent-%COMP%]   button.botoFoto[_ngcontent-%COMP%]   img.foto[_ngcontent-%COMP%]{width:150px;height:150px}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .col-form-label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0;padding:7px 0}.content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-grup[_ngcontent-%COMP%]   .form-camp[_ngcontent-%COMP%]{padding:6px 12px;border-width:1px;border-radius:20px}.carregant[_ngcontent-%COMP%]   app-loading[_ngcontent-%COMP%]{margin:100px auto}"]}),e})();var M=o(2080);const k=[{path:"",children:[{path:"",component:P}]}];let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[M.Bz.forChild(k)],M.Bz]}),e})();var E=o(355);let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[S,E.z,n.CommonModule,r.m,l.u5,d.zk]]}),e})()}}]);